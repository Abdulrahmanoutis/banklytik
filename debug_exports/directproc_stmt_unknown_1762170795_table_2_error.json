{
  "table": 2,
  "error": "expected string or bytes-like object",
  "trace": "Traceback (most recent call last):\n  File \"/Users/macbookpro/Documents/bankbot/banklytik/statements/direct_processor.py\", line 131, in process_tables_directly\n    cleaned = _clean_table_dataframe(df_table, normalize_text, parse_date_str, clean_amount, extract_channel)\n  File \"/Users/macbookpro/Documents/bankbot/banklytik/statements/direct_processor.py\", line 219, in _clean_table_dataframe\n    df[\"date\"] = df.get(\"date\", pd.Series([\"\"] * len(df))).apply(parse_date_str)\n  File \"/Users/macbookpro/Documents/anaconda3/envs/bank/lib/python3.10/site-packages/pandas/core/series.py\", line 4924, in apply\n    ).apply()\n  File \"/Users/macbookpro/Documents/anaconda3/envs/bank/lib/python3.10/site-packages/pandas/core/apply.py\", line 1427, in apply\n    return self.apply_standard()\n  File \"/Users/macbookpro/Documents/anaconda3/envs/bank/lib/python3.10/site-packages/pandas/core/apply.py\", line 1507, in apply_standard\n    mapped = obj._map_values(\n  File \"/Users/macbookpro/Documents/anaconda3/envs/bank/lib/python3.10/site-packages/pandas/core/base.py\", line 921, in _map_values\n    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)\n  File \"/Users/macbookpro/Documents/anaconda3/envs/bank/lib/python3.10/site-packages/pandas/core/algorithms.py\", line 1743, in map_array\n    return lib.map_infer(values, mapper, convert=convert)\n  File \"lib.pyx\", line 2972, in pandas._libs.lib.map_infer\n  File \"/Users/macbookpro/Documents/bankbot/banklytik/statements/cleaning_utils.py\", line 140, in parse_date_str\n    s_clean = re.sub(r\"[.,-]\", \" \", s)\n  File \"/Users/macbookpro/Documents/anaconda3/envs/bank/lib/python3.10/re.py\", line 209, in sub\n    return _compile(pattern, flags).sub(repl, string, count)\nTypeError: expected string or bytes-like object\n"
}